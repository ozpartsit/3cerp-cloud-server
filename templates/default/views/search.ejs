<div class="section pb-0">
     <div class="container">
          <div class="row">
               <!--Sidebar-->
               <div
                    class="col-12 col-sm-12 col-md-12 col-lg-3 sidebar filterbar order-2 order-lg-0 order-md-2 order-sm-2"
               >
                    <div class="closeFilter d-block d-lg-none">
                         <i class="cps cp-times"></i>
                    </div>
                    <div class="sidebar-filters">
                         <div class="shopby-title text-uppercase">
                              <h3>Shop by</h3>
                         </div>
                         <div class="nowshopby">
                              <div>
                                   <% if (data.content.filters) { %>
                                       <% data.content.filters.forEach((item) => { %>
                                           <div class="form-group mt-2">
                                               <label for="<%= item.field %>"><%= item.field %></label>
                                               <select class="form-control" id="<%= item.field %>"
                                                  <% if(item.multiple) { %>
                                                       multiple 
                                                       style="height: 250px;"
                                                  <% } %>
                                                  >
                                                   <% item.options && item.options.forEach((option) => { %>
                                                       <option value="<%= option._id %>">
                                                           <%= option.name %>
                                                       </option>
                                                   <% }) %>
                                               </select>
                                           </div>
                                       <% }) %>
                                   <% } %>
                               </div>
                         </div>
                         <hr />

                         <!--Price Filter Block-->
                         <div class="block filterBox filter-widget">
                              <div class="block-title">
                                   <h3>Price</h3>
                              </div>
                              <form
                                   action="#"
                                   method="post"
                                   class="price-filter filterDD mt-3"
                              >
                                   <div
                                        id="slider-range"
                                        class="mt-2 ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all"
                                   >
                                        <div
                                             class="ui-slider-range ui-widget-header ui-corner-all"
                                        ></div>
                                        <span
                                             class="ui-slider-handle ui-state-default ui-corner-all"
                                             tabindex="0"
                                        ></span
                                        ><span
                                             class="ui-slider-handle ui-state-default ui-corner-all"
                                             tabindex="0"
                                             style="left: 73.4043%"
                                        ></span>
                                   </div>
                                   <div class="row">
                                        <div class="col-6">
                                             <p class="no-margin">
                                                  <input
                                                       id="amount"
                                                       type="text"
                                                       class="rounded"
                                                  />
                                             </p>
                                        </div>
                                        <div
                                             class="col-6 text-end margin-25px-top"
                                        >
                                             <button
                                                  class="btn btn--small rounded"
                                             >
                                                  filter
                                             </button>
                                        </div>
                                   </div>
                              </form>
                         </div>
                         <!--End Price Filter Block-->

                         <!--Availability-->
                         <div
                              class="block filterBox filter-widget size-swacthes availability"
                         >
                              <div class="block-title">
                                   <h3 class="mb-0">Availability</h3>
                              </div>
                              <div class="filterDD">
                                   <ul
                                        class="clearfix"
                                        style="column-count: auto"
                                   >
                                        <li>
                                             <input
                                                  type="checkbox"
                                                  value="instock"
                                                  id="instock"
                                             /><label for="instock"
                                                  ><span></span>In stock</label
                                             >
                                        </li>
                                        <li>
                                             <input
                                                  type="checkbox"
                                                  value="outofstock"
                                                  id="outofstock"
                                             /><label for="outofstock"
                                                  ><span></span>Out of
                                                  stock</label
                                             >
                                        </li>
                                   </ul>
                              </div>
                         </div>
                         <!--End Availability-->

                         <!--End Popular Tags-->
                    </div>
               </div>
               <!--End Sidebar-->

               <!--Content-->
               <div class="col-12 col-sm-12 col-md-12 col-lg-9 main-col">
                    <!--Toolbar-->
                    <div class="toolbar py-3 pt-0">
                         <div class="filters-toolbar-wrapper">
                              <ul
                                   class="list-unstyled d-flex align-items-center justify-content-between m-0"
                              >
                                   <li
                                        class="collection-view d-flex align-items-center"
                                   >
                                        <div
                                             id="display_products_system"
                                             class="filters-toolbar__item collection-view-as d-flex align-items-center me-3"
                                        >
                                             <div
                                                  id="btn_grid_products_system"
                                                  class="change-view prd-grid"
                                                  value="grid"
                                             >
                                                  <i
                                                       class="cps cp-th-large"
                                                  ></i>
                                                  <span class="tooltip-label"
                                                       >Siatka</span
                                                  >
                                             </div>
                                             <div
                                                  id="btn_list_products_system"
                                                  class="change-view prd-list"
                                                  value="list"
                                             >
                                                  <i class="cps cp-list"></i>
                                                  <span class="tooltip-label"
                                                       >Lista</span
                                                  >
                                             </div>
                                        </div>
                                        <div
                                             class="product-count d-flex align-items-center"
                                        >
                                             <button
                                                  type="button"
                                                  class="btn rounded btn-filter d-block d-lg-none me-2 me-sm-3"
                                             >
                                                  <span class="hidden"
                                                       >Filtruj</span
                                                  >
                                             </button>
                                        </div>
                                   </li>
                                   <li
                                        class="filters-select ms-auto ms-sm-0 d-flex align-items-center"
                                   >
                                        <!-- ... (pozostaw swój istniejący kod selektorów) -->
                                   </li>
                              </ul>
                         </div>
                    </div>
                    <!--End Toolbar-->

                    <!--Product Grid-->
                    <div
                         id="grid_products_system"
                         class="products-grid"
                         name="container_products"
                    >
                         <div class="row">
                              <!--ITEMS-->
                              <% data.content.docs.forEach((item, index) => { %>
                              <div class="col-6 col-sm-6 col-md-4 col-lg-4">
                                   <div class="item">
                                        <!--Product Image-->
                                        <div class="product-image">
                                             <% if(item.images.length === 0) {
                                             %>
                                             <a
                                                  href="<%= `${data.page.host}/item/${item.urlComponent}` %>"
                                                  class="rounded-3 product-thumb"
                                             >
                                                  <img
                                                       class="primary blur-up lazyload rounded-3"
                                                       data-src="assets/images/products/250x250.jpg"
                                                       src="assets/images/products/250x250.jpg"
                                                       alt="<%= item.name %>"
                                                       title="<%= item.name %>"
                                                  />
                                             </a>
                                             <% } %> <% if(item.images.length
                                             === 1) {%>
                                             <a
                                                  href="<%= `${data.page.host}/item/${item.urlComponent}` %>"
                                                  class="rounded-3 product-thumb"
                                             >
                                                  <img
                                                       class="primary blur-up lazyload rounded-3"
                                                       data-src="<%= item.images[0].fullPath%>"
                                                       src="<%= item.images[0].fullPath%>"
                                                       alt="<%= item.images[0].name %>"
                                                       title="<%= item.images[0].name %>"
                                                  />
                                             </a>
                                             <% } %> <% if(item.images.length >=
                                             2) {%>
                                             <a
                                                  href="<%= `${data.page.host}/item/${item.urlComponent}` %>"
                                                  class="rounded-3 product-thumb"
                                             >
                                                  <img
                                                       class="primary blur-up lazyload rounded-3"
                                                       data-src="<%= item.images[0].fullPath%>"
                                                       src="<%= item.images[0].fullPath%>"
                                                       alt="<%= item.images[0].name %>"
                                                       title="<%= item.images[0].name %>"
                                                  />
                                                  <img
                                                       class="hover blur-up lazyload rounded-3"
                                                       data-src="<%= item.images[1].fullPath%>"
                                                       src="<%= item.images[1].fullPath%>"
                                                       alt="<%= item.images[1].name %>"
                                                       title="<%= item.images[1].name %>"
                                                  />
                                             </a>
                                             <% } %>

                                             <!--Product Labels-->
                                             <% if(item.quantityAvailable > 2 )
                                             {%>
                                             <div class="product-labels">
                                                  <span
                                                       class="pr-label3 lbl new rounded"
                                                       ><%=
                                                       `${i18n.__("locales.stock-status.in-stock")}:
                                                       ${item.quantityAvailable}`
                                                       %></span
                                                  >
                                             </div>
                                             <% } %> <%
                                             if(item.quantityAvailable <= 2 &&
                                             item.quantityAvailable !== 0) { %>
                                             <div class="product-labels">
                                                  <span
                                                       class="pr-label2 hot lbl new rounded"
                                                       ><%=
                                                       `${i18n.__("locales.stock-status.in-stock")}:
                                                       ${item.quantityAvailable}`
                                                       %></span
                                                  >
                                             </div>
                                             <% } %> <%
                                             if(item.quantityAvailable === 0 )
                                             {%>
                                             <div class="product-labels">
                                                  <span
                                                       class="on-sale lbl rounded"
                                                       ><%=
                                                       `${i18n.__("locales.stock-status.not-available")}`
                                                       %></span
                                                  >
                                             </div>
                                             <% } %>
                                             <!--End Product Labels-->

                                             <!--Button Action-->
                                             <div class="button-hover">
                                                  <span
                                                       class="btn btn-wishlist"
                                                       title="Wishlist"
                                                  >
                                                       <i
                                                            index="<%= index %>"
                                                            product_id="<%= item.id %>"
                                                            action="add_to_favorites"
                                                            class="cpr cp-heart"
                                                       ></i>
                                                  </span>
                                                  <span
                                                       class="btn pro-addtocart-popup rounded btn-cart btn-primary"
                                                       title="Add To Cart"
                                                  >
                                                       <i
                                                            index="<%= index %>"
                                                            product_id="<%= item.id %>"
                                                            action="add_to_cart"
                                                            class="cps cp-shopping-cart"
                                                       ></i>
                                                  </span>
                                             </div>
                                             <!--End Button Action-->
                                        </div>
                                        <!--End Product Image-->

                                        <!--Product Details-->
                                        <div class="product-details d-flex">
                                             <div class="product-details-in">
                                                  <div class="h3">
                                                       <a
                                                            href="<%= `${data.page.host}/item/${item.urlComponent}` %>"
                                                            ><%= item.name %></a
                                                       >
                                                  </div>
                                                  <div class="price-box">
                                                       <span class="price"
                                                            ><%=
                                                            item.priceFormat
                                                            %></span
                                                       >
                                                  </div>
                                             </div>
                                        </div>
                                        <!--End Product Details-->
                                   </div>
                              </div>
                              <% }); %>
                         </div>
                    </div>
                    <!--End Product Grid-->

                    <!--Product List-->
                    <div
                         id="list_products_system"
                         class="products-list"
                         name="container_products"
                    >
                         <div class="row">
                              <% data.content.docs.forEach((item, index) => { %>
                              <div class="col-12">
                                   <!--Product Item-->
                                   <div class="item d-flex align-items-center">
                                        <!--Product Image-->
                                        <div class="product-image flex-1">
                                             <% if(item.images.length === 0) {
                                             %>
                                             <a
                                                  href="<%= `${data.page.host}/item/${item.urlComponent}` %>"
                                                  class="rounded-3 product-thumb"
                                             >
                                                  <img
                                                       class="primary blur-up lazyload rounded-3"
                                                       data-src="assets/images/products/250x250.jpg"
                                                       src="assets/images/products/250x250.jpg"
                                                       alt="<%= item.name %>"
                                                       title="<%= item.name %>"
                                                  />
                                             </a>
                                             <% } %> <% if(item.images.length
                                             === 1) {%>
                                             <a
                                                  href="<%= `${data.page.host}/item/${item.urlComponent}` %>"
                                                  class="rounded-3 product-thumb"
                                             >
                                                  <img
                                                       class="primary blur-up lazyload rounded-3"
                                                       data-src="<%= item.images[0].fullPath%>"
                                                       src="<%= item.images[0].fullPath%>"
                                                       alt="<%= item.images[0].name %>"
                                                       title="<%= item.images[0].name %>"
                                                  />
                                             </a>
                                             <% } %> <% if(item.images.length >=
                                             2) {%>
                                             <a
                                                  href="<%= `${data.page.host}/item/${item.urlComponent}` %>"
                                                  class="rounded-3 product-thumb"
                                             >
                                                  <img
                                                       class="primary blur-up lazyload rounded-3"
                                                       data-src="<%= item.images[0].fullPath%>"
                                                       src="<%= item.images[0].fullPath%>"
                                                       alt="<%= item.images[0].name %>"
                                                       title="<%= item.images[0].name %>"
                                                  />
                                                  <img
                                                       class="hover blur-up lazyload rounded-3"
                                                       data-src="<%= item.images[1].fullPath%>"
                                                       src="<%= item.images[1].fullPath%>"
                                                       alt="<%= item.images[1].name %>"
                                                       title="<%= item.images[1].name %>"
                                                  />
                                             </a>
                                             <% } %>

                                             <!--Product Labels-->
                                             <% if(item.quantityAvailable > 2 )
                                             {%>
                                             <div class="product-labels">
                                                  <span
                                                       class="pr-label3 lbl new rounded"
                                                       ><%=
                                                       `${i18n.__("locales.stock-status.in-stock")}:
                                                       ${item.quantityAvailable}`
                                                       %></span
                                                  >
                                             </div>
                                             <% } %> <%
                                             if(item.quantityAvailable <= 2 &&
                                             item.quantityAvailable !== 0) { %>
                                             <div class="product-labels">
                                                  <span
                                                       class="pr-label2 hot lbl new rounded"
                                                       ><%=
                                                       `${i18n.__("locales.stock-status.in-stock")}:
                                                       ${item.quantityAvailable}`
                                                       %></span
                                                  >
                                             </div>
                                             <% } %> <%
                                             if(item.quantityAvailable === 0 )
                                             {%>
                                             <div class="product-labels">
                                                  <span
                                                       class="on-sale lbl rounded"
                                                       ><%=
                                                       i18n.__("locales.stock-status.not-available")
                                                       %></span
                                                  >
                                             </div>
                                             <% } %>
                                             <!--End Product Labels-->

                                             <!--Button Action-->
                                             <div class="button-hover">
                                                  <span
                                                       class="btn btn-wishlist"
                                                       title="Wishlist"
                                                  >
                                                       <i
                                                            index="<%= index %>"
                                                            product_id="<%= item.id %>"
                                                            action="add_to_favorites"
                                                            class="cpr cp-heart"
                                                       ></i>
                                                  </span>
                                                  <span
                                                       class="btn pro-addtocart-popup rounded btn-cart btn-primary"
                                                       title="Add To Cart"
                                                  >
                                                       <i
                                                            index="<%= index %>"
                                                            product_id="<%= item.id %>"
                                                            action="add_to_cart"
                                                            class="cps cp-shopping-cart"
                                                       ></i>
                                                  </span>
                                             </div>
                                             <!--End Button Action-->
                                        </div>
                                        <!--End Product Image-->

                                        <!--Product Details-->
                                        <div class="product-details flex-1">
                                             <div class="product-details-in">
                                                  <div class="h3">
                                                       <a
                                                            href="<%= `${data.page.host}/item/${item.urlComponent}` %>"
                                                            ><%= item.name %></a
                                                       >
                                                  </div>
                                                  <div class="price-box">
                                                       <span class="price"
                                                            ><%=
                                                            item.priceFormat
                                                            %></span
                                                       >
                                                  </div>
                                                  <div class="product-review">
                                                       <!-- Przykładowe gwiazdki ocen -->
                                                       <i
                                                            class="cps cp-star"
                                                       ></i
                                                       ><i
                                                            class="cps cp-star"
                                                       ></i
                                                       ><i
                                                            class="cps cp-star"
                                                       ></i
                                                       ><i
                                                            class="cps cp-star"
                                                       ></i
                                                       ><i
                                                            class="cpr cp-star"
                                                       ></i>
                                                       <span class="sep"
                                                            >|</span
                                                       >
                                                       2 Opinie
                                                  </div>
                                                  <div class="sort-description">
                                                       <p>
                                                            <%= item.description
                                                            %>
                                                       </p>
                                                  </div>
                                             </div>
                                        </div>
                                        <!--End Product Details-->
                                   </div>
                                   <!--End Product Item-->
                              </div>
                              <% }); %>
                         </div>
                    </div>
                    <!--End Product List-->

                    <!--Pagination-->
                    <div class="row">
                         <div class="col-12">
                              <div class="pagination">
                                   <div class="container mb-5">
                                        <ul
                                             id="main_pagination_block"
                                             class="d-flex align-items-center justify-content-center"
                                        ></ul>
                                   </div>
                              </div>
                         </div>
                    </div>
                    <!--End Pagination-->
               </div>
               <!--End Content-->
          </div>
     </div>
</div>

<!-- Skrypt JavaScript -->
<script>
     // Pobieranie elementów DOM
     const btnListView = document.querySelector("#btn_list_products_system");
     const btnGridView = document.querySelector("#btn_grid_products_system");
     const listView = document.querySelector("#list_products_system");
     const gridView = document.querySelector("#grid_products_system");

     const setDisplayProductsSystem = () => {
          let displaySystem =
               localStorage.getItem("display_products_system") || "grid";

          if (displaySystem === "list") {
               if (btnListView) btnListView.classList.add("active");
               if (btnGridView) btnGridView.classList.remove("active");

               if (gridView) gridView.style.display = "none";
               if (listView) listView.style.display = "block";
          } else {
               if (btnGridView) btnGridView.classList.add("active");
               if (btnListView) btnListView.classList.remove("active");

               if (listView) listView.style.display = "none";
               if (gridView) gridView.style.display = "block";
          }
     };

     const changeDisplayProductsSystem = () => {
          const displayProductsSystem = document.querySelector(
               "#display_products_system"
          );

          if (!displayProductsSystem) return;

          displayProductsSystem.addEventListener("click", (e) => {
               const target = e.target.closest(".change-view");
               if (!target) return;
               const new_value = target.getAttribute("value");

               if (new_value) {
                    localStorage.setItem("display_products_system", new_value);

                    setDisplayProductsSystem();
               }
          });
     };

     // Wywołanie funkcji po załadowaniu strony
     setDisplayProductsSystem();
     changeDisplayProductsSystem();
</script>
